<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrar Propiedad</title>
    <link rel="stylesheet" href="/Styles/styles.css">
    <script src="/javascript/funcionesflat.js" type="text/javascript"></script>
</head>

<input type="text" id="usuario" hidden >
  
<body onload="DefinirUsuario();">
    <nav>
        <img src="/img/logo.svg" alt="logo rentease">
        <div class="nav-bar">
            <a href="./Home.html">Home</a>
            <a href="./All_Flats.html">Mis Flats</a>
            <a href="./New_Flats.html">New Flat</a>
            <a href="./Profile_Update.html">Profile update</a>
            <a href="/html/Login.html">Cerrar Sesion</a>
        </div>
    </nav>

    <div id="mensaje" hidden ></div>
    <div id="resultadoNombre"></div>
    <script>
        var DefinirUsuario = function() {
            const usuario = localStorage.getItem('usuarioLogeado');
            if (usuario) {
                document.getElementById('mensaje').innerHTML = "Bienvenido " + usuario;
                document.getElementById('resultadoNombre').innerHTML = "Bienvenido " + localStorage.getItem('NombreLogueado');
                document.getElementById('usuario').value = usuario;

            } else {
               // document.getElementById('mensaje').innerHTML = "No hay usuario logueado.";
                alert("No hay usuario Logueado");
            }
        }
        
        // Llamar a la función cuando el documento esté completamente cargado
        document.addEventListener('DOMContentLoaded', (event) => {
            DefinirUsuario();
        });
    </script>

<div class="contenedor">
    <div class="login-form">
    <form>
        <label class="letra" for="">Ciudad:</label><br>
        <input class="inputs-medidas inputs" type="text" id="Ciudad" placeholder="Ingrese una ciudad"minlength="2" maxlength="20" autofocus required /> <br><br>
        <label class="letra" for="">Dirección:</label><br>
        <input class="inputs-medidas inputs" type="text" id="Direccion" placeholder="Ingrese dirección" minlength="2" maxlength="25"/><br><br>
        <label class="letra" for="">Numeración domiciliaria:</label><br>
        <input class="inputs-medidas inputs" type="text" id="NumeracionBien" placeholder="Ingrese el número del bien" maxlength="10"/><br><br>
        <label class="letra" for="">Área Total:</label><br>
        <input class="inputs-medidas inputs" type="text" id="Area" placeholder="Ingrese el área" minlength="2" maxlength="10"/><br><br>
        <label class="" for="aire"> Dispone de Aire Acondicionado ?</label> <br>
        <input  type="radio" id="Aire" name="aire" value="SI" /> SI
        <input type="radio" id="Aire" name="aire" value="NO" checked="" /> NO <br><br>
        <label class="letra" for="">Año de construcción:</label><br>
        <input class="inputs-medidas inputs" type="text" id="Anio" placeholder="Ingrese el año de construcción"minlength="2" maxlength="10" /><br><br>
        <label class="letra" for="">Precio de arrendamiento:</label><br>
        <input class="inputs-medidas inputs" type="text" id="Precio" placeholder="Ingrese el precio" minlength="2" maxlength="10"/><br><br>
        <label class="letra" for="">Disponibilidad de arriendo:</label><br>
        <input class="inputs-medidas inputs" type="date" name="edad" id="Disponible" required>
        <br>
        <br>
        <button class="inputs-medidas inputs" type="submit" onclick="ValidarSoloLetras();ValidarSoloNumeros();ValidadFlat()">Registrar Propiedad</button>
    </form>

</div>
   
</div>


    <script>
 let ValidadFlat= function(){
    let idRegistro = ['usuario','Ciudad', 'Direccion', 'NumeracionBien','Area', 'Aire', 'Anio','Precio','Disponible'];
    for(let item of idRegistro){
                if(!document.getElementById(item).value){
                    alert(`El campo ${item} está vacio, por favor ingresa un dato válido`);
                    return;
                }
            }
            let flat = {
            usuario:'',
            city: '',
            streetname:'',
            streetnumber: '',
            size:'',
            ac: '',
            year: '',
            price:'',
            date:'',
           
            }

            let usuario= document.getElementById('usuario').value;
            let city = document.getElementById('Ciudad').value;
            let streetname= document.getElementById('Direccion').value;
            let streetnumber = document.getElementById('NumeracionBien').value;
            let size = document.getElementById('Area').value;
            let ac = document.querySelector('input[name=aire]:checked').value;
            let year= document.getElementById('Anio').value;
            let price = document.getElementById('Precio').value;
            let date= document.getElementById('Disponible').value;
           
           

            flat = {usuario,city, streetname, streetnumber ,size ,ac ,year ,price ,date};
 
            let resultado = RegistrarFlat(flat); 
            if(resultado == "OK")
            {
                alert("**Bien Registrado**");
                console.log(resultado);
              
            }
            else{
                alert(resultado);
            }
            

        }

    </script>

</body>
</html>